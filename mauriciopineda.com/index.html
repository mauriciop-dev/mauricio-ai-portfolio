import React, { useState, useRef, useEffect } from 'react';
import { Play, Globe, MessageCircle, Database, Server, Bot, Code } from 'lucide-react';

// NOTA PARA MAURICIO:
// En tu proyecto real, cambia estas rutas por las de tus videos en la carpeta public:
// const VIDEOS = {
// idle: '/videos/idle.mp4',
// intro_es: '/videos/intro_es.mp4',
// intro_en: '/videos/intro_en.mp4',
// reaction: '/videos/reaction.mp4'
// };

// Simulaci贸n para esta demo (borra esto en tu c贸digo real)
const VIDEO_MOCKS = {
idle: { color: 'bg-gray-900', text: ' IDLE (Bucle infinito - Esperando usuario)', sub: 'Parpadeando, respirando...' },
intro_es: { color: 'bg-blue-900', text: ' INTRO ESPAOL', sub: 'Hola, soy Mauricio. Mira mis proyectos abajo...' },
intro_en: { color: 'bg-purple-900', text: '吼 INTRO ENGLISH (AI Voice)', sub: 'Hi, I am Mauricio. Check out my agentic
workflows...' },
reaction: { color: 'bg-emerald-900', text: ' REACCIN (Mirando botones)', sub: 'Bajando la mirada hacia la
interfaz...' }
};

export default function Portfolio() {
const [currentState, setCurrentState] = useState('idle'); // idle, intro_es, intro_en, reaction
const [isPlaying, setIsPlaying] = useState(false);
const videoRef = useRef(null);

// Manejo de fin de video
const handleVideoEnd = () => {
// Si termina una intro o reacci贸n, volvemos al bucle 'idle'
if (currentState !== 'idle') {
setCurrentState('idle');
}
};

// Funci贸n para activar intros
const playIntro = (lang) => {
setCurrentState(lang === 'es' ? 'intro_es' : 'intro_en');
setIsPlaying(true);
};

// Funciones para Hover en botones (activar video reacci贸n)
const handleMouseEnter = () => {
// Solo reacciona si est谩 en idle (para no cortar la intro si est谩 hablando)
if (currentState === 'idle') {
setCurrentState('reaction');
}
};

const handleMouseLeave = () => {
if (currentState === 'reaction') {
setCurrentState('idle');
}
};

return (
<div
    className="relative w-full h-screen bg-black overflow-hidden flex flex-col items-center justify-center font-sans text-white">

    {/* --- CONTENEDOR DE VIDEO --- */}
    <div className="absolute inset-0 z-0 w-full h-full">
        {/* TRUCO VIBE CODER: scale-105 hace un ligero zoom para sacar
        la marca de agua de HeyGen fuera de la pantalla.
        */}
        <div className={`w-full h-full transition-colors duration-500 ease-in-out flex items-center justify-center
            transform scale-105 ${VIDEO_MOCKS[currentState].color}`}>
            {/* AQU IRA TU ETIQUETA DE VIDEO REAL:
            <video src={VIDEOS[currentState]} autoPlay muted={currentState==='idle' } // Idle debe ser mudo
                loop={currentState==='idle' } // Solo idle es loop onEnded={handleVideoEnd}
                className="w-full h-full object-cover" />
            */}

            {/* Placeholder visual para la demo */}
            <div className="text-center p-10">
                <h1 className="text-4xl font-bold mb-4">{VIDEO_MOCKS[currentState].text}</h1>
                <p className="text-xl opacity-75 animate-pulse">{VIDEO_MOCKS[currentState].sub}</p>

                {currentState === 'idle' && (
                <div className="mt-8 p-4 bg-black/30 rounded-lg backdrop-blur-sm inline-block">
                    <p className="text-sm">癸 En el c贸digo real, aqu铆 se reproduce <b>idle.mp4</b> en bucle.</p>
                </div>
                )}
            </div>
        </div>

        {/* Overlay Gradiente para que los botones se lean bien */}
        <div
            className="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-black/40 pointer-events-none">
        </div>
    </div>

    {/* --- INTERFAZ DE USUARIO (UI) --- */}

    {/* Header: Selector de Idioma */}
    <div className="absolute top-8 z-20 flex gap-4">
        <button onClick={()=> playIntro('es')}
            className={`flex items-center gap-2 px-6 py-3 rounded-full backdrop-blur-md transition-all duration-300
            border ${currentState === 'intro_es' ? 'bg-blue-600/80 border-blue-400
            shadow-[0_0_20px_rgba(37,99,235,0.5)]' : 'bg-white/10 border-white/20 hover:bg-white/20'}`}
            >
            <span className="text-2xl"></span>
            <span className="font-medium">Hola, soy Mauricio</span>
        </button>

        <button onClick={()=> playIntro('en')}
            className={`flex items-center gap-2 px-6 py-3 rounded-full backdrop-blur-md transition-all duration-300
            border ${currentState === 'intro_en' ? 'bg-purple-600/80 border-purple-400
            shadow-[0_0_20px_rgba(147,51,234,0.5)]' : 'bg-white/10 border-white/20 hover:bg-white/20'}`}
            >
            <span className="text-2xl">吼</span>
            <span className="font-medium">Hi, I'm AI-Mauricio</span>
            <Bot size={18} className="text-purple-300" />
        </button>
    </div>

    {/* Footer: Botonera de Proyectos (Tu boceto) */}
    <div className="absolute bottom-12 z-20 w-full max-w-4xl px-6">
        <p className="text-center text-white/60 mb-6 text-sm uppercase tracking-widest">Explora mi portafolio</p>

        <div className="flex flex-wrap justify-center gap-4 md:gap-6">

            {/* Bot贸n 1: Landing Pages */}
            <ProjectButton icon={<Globe size={24} />}
            label="Web Apps"
            sub="Next.js + Supabase"
            onEnter={handleMouseEnter}
            onLeave={handleMouseLeave}
            />

            {/* Bot贸n 2: WhatsApp Bots */}
            <ProjectButton icon={<MessageCircle size={24} />}
            label="WhatsApp API"
            sub="Meta Developer"
            color="hover:bg-green-600/80 hover:border-green-400 hover:shadow-[0_0_30px_rgba(34,197,94,0.4)]"
            onEnter={handleMouseEnter}
            onLeave={handleMouseLeave}
            />

            {/* Bot贸n 3: Power Platform */}
            <ProjectButton icon={<Database size={24} />}
            label="Power Apps"
            sub="Microsoft Fabric"
            color="hover:bg-pink-600/80 hover:border-pink-400 hover:shadow-[0_0_30px_rgba(236,72,153,0.4)]"
            onEnter={handleMouseEnter}
            onLeave={handleMouseLeave}
            />

            {/* Bot贸n 4: PAIC Platform */}
            <ProjectButton icon={<Server size={24} />}
            label="PAIC.com.co"
            sub="SaaS Completo"
            color="hover:bg-blue-600/80 hover:border-blue-400 hover:shadow-[0_0_30px_rgba(59,130,246,0.4)]"
            onEnter={handleMouseEnter}
            onLeave={handleMouseLeave}
            />

            {/* Bot贸n 5: n8n Automation */}
            <ProjectButton icon={<Code size={24} />}
            label="n8n Workflows"
            sub="Automation"
            color="hover:bg-orange-600/80 hover:border-orange-400 hover:shadow-[0_0_30px_rgba(249,115,22,0.4)]"
            onEnter={handleMouseEnter}
            onLeave={handleMouseLeave}
            />

            {/* Bot贸n 6: AutoGen */}
            <ProjectButton icon={<Bot size={24} />}
            label="AutoGen Agents"
            sub="Multi-Agent Systems"
            color="hover:bg-indigo-600/80 hover:border-indigo-400 hover:shadow-[0_0_30px_rgba(99,102,241,0.4)]"
            onEnter={handleMouseEnter}
            onLeave={handleMouseLeave}
            />

        </div>
    </div>
</div>
);
}

// Componente de Bot贸n Reutilizable
function ProjectButton({ icon, label, sub, onEnter, onLeave, color = "hover:bg-white/20" }) {
return (
<button className={`group relative flex flex-col items-center justify-center w-28 h-28 md:w-32 md:h-32 rounded-2xl
    bg-black/40 border border-white/10 backdrop-blur-md transition-all duration-300 ${color} hover:-translate-y-2`}
    onMouseEnter={onEnter} onMouseLeave={onLeave}>
    <div className="mb-2 text-white/90 group-hover:scale-110 transition-transform duration-300">
        {icon}
    </div>
    <span className="font-bold text-sm text-white">{label}</span>
    <span className="text-[10px] text-white/60 mt-1">{sub}</span>

    {/* Indicador de 'Click' visual */}
    <div
        className="absolute inset-0 rounded-2xl border border-white/0 group-hover:border-white/30 transition-all duration-500">
    </div>
</button>
);
}